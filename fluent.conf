<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Add hostname
<filter **>
  @type record_transformer
  <record>
    hostname ${hostname}
  </record>
</filter>

<match **>
  type copy
  <store>
    type stdout
  </store>
  <store>
    @type forward
    send_timeout 60s
    recover_wait 10s
    flush_interval 5s
    # As we use a ha proxy load balancer in front heartbeat is done over udp so we will have to disable it
    heartbeat_type none
    #heartbeat_interval 1s
    phi_threshold 16
    hard_timeout 60s

    <server>
      host fluentd-indexer
      port 24225
      weight 60
    </server>

  </store>
</match>

